<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Equilibrium Nest Group Equilibrium | BFW Equilibrium Gender LFP and Wage Code Companion</title>
  <meta name="description" content="bfw_solveequi_w2q2w" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Equilibrium Nest Group Equilibrium | BFW Equilibrium Gender LFP and Wage Code Companion" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="bfw_solveequi_w2q2w" />
  <meta name="github-repo" content="fanwangecon/PrjLabEquiBFW" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Equilibrium Nest Group Equilibrium | BFW Equilibrium Gender LFP and Wage Code Companion" />
  
  <meta name="twitter:description" content="bfw_solveequi_w2q2w" />
  

<meta name="author" content="Sonia R. Bhalotra, Manuel Fernández, and Fan Wang" />


<meta name="date" content="2022-02-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="supply.html"/>
<link rel="next" href="index-and-code-links.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-12"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-12');
</script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BFW Equilibrium Gender LFP and Wage Code Companion</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#bhalotra-fernández-and-wang-2022"><i class="fa fa-check"></i><b>1.1</b> Bhalotra, Fernández, and Wang (2022)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="core-functions.html"><a href="core-functions.html"><i class="fa fa-check"></i><b>2</b> Core Functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="core-functions.html"><a href="core-functions.html#ces-demand-core-functions"><i class="fa fa-check"></i><b>2.1</b> CES Demand Core Functions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="core-functions.html"><a href="core-functions.html#default-test"><i class="fa fa-check"></i><b>2.1.1</b> Default Test</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="core-functions.html"><a href="core-functions.html#multinomial-logit-core-functions"><i class="fa fa-check"></i><b>2.2</b> Multinomial Logit Core Functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="core-functions.html"><a href="core-functions.html#test-bl_log_wage-is-false"><i class="fa fa-check"></i><b>2.2.1</b> Test BL_LOG_WAGE is false</a></li>
<li class="chapter" data-level="2.2.2" data-path="core-functions.html"><a href="core-functions.html#test-bl_log_wage-is-false-1"><i class="fa fa-check"></i><b>2.2.2</b> Test BL_LOG_WAGE is false</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="core-functions.html"><a href="core-functions.html#equilibrium-core-functions"><i class="fa fa-check"></i><b>2.3</b> Equilibrium Core Functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="core-functions.html"><a href="core-functions.html#default-test-1"><i class="fa fa-check"></i><b>2.3.1</b> Default Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="parameters.html"><a href="parameters.html"><i class="fa fa-check"></i><b>3</b> Parameters</a>
<ul>
<li class="chapter" data-level="3.1" data-path="parameters.html"><a href="parameters.html#bfw_mp_path"><i class="fa fa-check"></i><b>3.1</b> bfw_mp_path</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="parameters.html"><a href="parameters.html#default-map-of-path-fan-path"><i class="fa fa-check"></i><b>3.1.1</b> Default Map of Path (Fan path)</a></li>
<li class="chapter" data-level="3.1.2" data-path="parameters.html"><a href="parameters.html#map-of-path-for-alternative-path-installer"><i class="fa fa-check"></i><b>3.1.2</b> Map of Path for Alternative Path Installer</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="parameters.html"><a href="parameters.html#bfw_mp_control"><i class="fa fa-check"></i><b>3.2</b> bfw_mp_control</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="parameters.html"><a href="parameters.html#map-of-control-parameters"><i class="fa fa-check"></i><b>3.2.1</b> Map of Control Parameters</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="parameters.html"><a href="parameters.html#bfw_mp_param_esti"><i class="fa fa-check"></i><b>3.3</b> bfw_mp_param_esti</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="parameters.html"><a href="parameters.html#map-of-estimated-parameters"><i class="fa fa-check"></i><b>3.3.1</b> Map of Estimated Parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#bfw_mp_data"><i class="fa fa-check"></i><b>4.1</b> bfw_mp_data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data.html"><a href="data.html#get-all-data"><i class="fa fa-check"></i><b>4.1.1</b> Get All Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="data.html"><a href="data.html#dataset-1"><i class="fa fa-check"></i><b>4.1.2</b> Dataset 1</a></li>
<li class="chapter" data-level="4.1.3" data-path="data.html"><a href="data.html#dataset-1-aux"><i class="fa fa-check"></i><b>4.1.3</b> Dataset 1 Aux</a></li>
<li class="chapter" data-level="4.1.4" data-path="data.html"><a href="data.html#dataset-2"><i class="fa fa-check"></i><b>4.1.4</b> Dataset 2</a></li>
<li class="chapter" data-level="4.1.5" data-path="data.html"><a href="data.html#dataset-2-aux"><i class="fa fa-check"></i><b>4.1.5</b> Dataset 2 Aux</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="demand.html"><a href="demand.html"><i class="fa fa-check"></i><b>5</b> Demand</a>
<ul>
<li class="chapter" data-level="5.1" data-path="demand.html"><a href="demand.html#solve-nested-ces-optimal-demand-crs"><i class="fa fa-check"></i><b>5.1</b> Solve Nested CES Optimal Demand (CRS)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="demand.html"><a href="demand.html#key-inputs-and-outputs-for-bfw_mp_func_demand"><i class="fa fa-check"></i><b>5.1.1</b> Key Inputs and Outputs for <span><strong>bfw_mp_func_demand</strong></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="demand.html"><a href="demand.html#single-nest-layer-two-inputs-ces-problem-demand"><i class="fa fa-check"></i><b>5.1.2</b> Single Nest Layer Two Inputs CES Problem (Demand)</a></li>
<li class="chapter" data-level="5.1.3" data-path="demand.html"><a href="demand.html#single-nest-layer-two-inputs-ces-problem-vary-share-and-elasticity-demand"><i class="fa fa-check"></i><b>5.1.3</b> Single Nest Layer Two Inputs CES Problem, Vary Share and Elasticity (Demand)</a></li>
<li class="chapter" data-level="5.1.4" data-path="demand.html"><a href="demand.html#doubly-nest-layer-two-inputs-each-sub-nest-ces-problem-demand"><i class="fa fa-check"></i><b>5.1.4</b> Doubly Nest Layer Two Inputs Each Sub-nest CES Problem (Demand)</a></li>
<li class="chapter" data-level="5.1.5" data-path="demand.html"><a href="demand.html#doubly-nest-layer-two-inputs-each-sub-nest-ces-problemsolution-check-demand"><i class="fa fa-check"></i><b>5.1.5</b> Doubly Nest Layer Two Inputs Each Sub-nest CES Problem–Solution Check (Demand)</a></li>
<li class="chapter" data-level="5.1.6" data-path="demand.html"><a href="demand.html#bfw-2022-nested-three-branch-four-layer-problem-demand"><i class="fa fa-check"></i><b>5.1.6</b> BFW (2022) Nested Three Branch (Four Layer) Problem (Demand)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="demand.html"><a href="demand.html#compute-nested-ces-mpl-given-demand-crs"><i class="fa fa-check"></i><b>5.2</b> Compute Nested CES MPL Given Demand (CRS)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="demand.html"><a href="demand.html#key-inputs-and-outputs-for-bfw_crs_nested_ces_mpl"><i class="fa fa-check"></i><b>5.2.1</b> Key Inputs and Outputs for <span><strong>bfw_crs_nested_ces_mpl</strong></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="demand.html"><a href="demand.html#single-nest-layer-two-inputs-ces-problem-mpl"><i class="fa fa-check"></i><b>5.2.2</b> Single Nest Layer Two Inputs CES Problem (MPL)</a></li>
<li class="chapter" data-level="5.2.3" data-path="demand.html"><a href="demand.html#single-nest-layer-two-inputs-ces-problem-vary-share-and-elasticity-mpl"><i class="fa fa-check"></i><b>5.2.3</b> Single Nest Layer Two Inputs CES Problem, Vary Share and Elasticity (MPL)</a></li>
<li class="chapter" data-level="5.2.4" data-path="demand.html"><a href="demand.html#doubly-nest-layer-two-inputs-each-sub-nest-ces-problem"><i class="fa fa-check"></i><b>5.2.4</b> Doubly Nest Layer Two Inputs Each Sub-nest CES Problem</a></li>
<li class="chapter" data-level="5.2.5" data-path="demand.html"><a href="demand.html#bfw-2022-nested-three-branch-four-layer-problem-mpl"><i class="fa fa-check"></i><b>5.2.5</b> BFW (2022) Nested Three Branch (Four Layer) Problem (MPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="supply.html"><a href="supply.html"><i class="fa fa-check"></i><b>6</b> Supply</a>
<ul>
<li class="chapter" data-level="6.1" data-path="supply.html"><a href="supply.html#bfw_mlogit"><i class="fa fa-check"></i><b>6.1</b> bfw_mlogit</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="supply.html"><a href="supply.html#default"><i class="fa fa-check"></i><b>6.1.1</b> Default</a></li>
<li class="chapter" data-level="6.1.2" data-path="supply.html"><a href="supply.html#visualize-supply-curves-different-years"><i class="fa fa-check"></i><b>6.1.2</b> Visualize Supply Curves Different Years</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html"><i class="fa fa-check"></i><b>7</b> Equilibrium Nest Group Equilibrium</a>
<ul>
<li class="chapter" data-level="7.1" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#root-search-equilibrium-wage-equations-by-skill-group"><i class="fa fa-check"></i><b>7.1</b> Root Search Equilibrium Wage Equations By Skill Group</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#default-1"><i class="fa fa-check"></i><b>7.1.1</b> Default</a></li>
<li class="chapter" data-level="7.1.2" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#vary-parameters-solve-equilibrium-quantitieswages-root-search"><i class="fa fa-check"></i><b>7.1.2</b> Vary Parameters, Solve Equilibrium Quantities/Wages, Root Search</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#equilibrium-w-to-q-to-w-contraction"><i class="fa fa-check"></i><b>7.2</b> Equilibrium W to Q to W Contraction</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#default-2"><i class="fa fa-check"></i><b>7.2.1</b> Default</a></li>
<li class="chapter" data-level="7.2.2" data-path="equilibrium-nest-group-equilibrium.html"><a href="equilibrium-nest-group-equilibrium.html#vary-parameters-solve-equilibrium-quantities-wages-w-to-q-to-w-contraction"><i class="fa fa-check"></i><b>7.2.2</b> Vary Parameters, Solve Equilibrium Quantities Wages, W to Q to W Contraction</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a>
<ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#introduction-links"><i class="fa fa-check"></i><b>A.1</b> Introduction links</a></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#core-functions-links"><i class="fa fa-check"></i><b>A.2</b> Core Functions links</a></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#parameters-links"><i class="fa fa-check"></i><b>A.3</b> Parameters links</a></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#data-links"><i class="fa fa-check"></i><b>A.4</b> Data links</a></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#demand-links"><i class="fa fa-check"></i><b>A.5</b> Demand links</a></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#supply-links"><i class="fa fa-check"></i><b>A.6</b> Supply links</a></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#equilibrium-nest-group-equilibrium-links"><i class="fa fa-check"></i><b>A.7</b> Equilibrium Nest Group Equilibrium links</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/PrjLabEquiBFW/bookdown/index.html" target="blank">PrjLabEquiBFW Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BFW Equilibrium Gender LFP and Wage Code Companion</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="equilibrium-nest-group-equilibrium" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Equilibrium Nest Group Equilibrium</h1>

<div id="root-search-equilibrium-wage-equations-by-skill-group" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Root Search Equilibrium Wage Equations By Skill Group</h2>
<p>This is the example vignette for function: bfw_solveequi_kwfw from the
<a href="https://fanwangecon.github.io/PrjLabEquiBFW/"><strong>PrjLabEquiBFW
Package</strong></a><strong>.</strong></p>
<div id="default-1" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Default</h3>
<pre><code>[mp_fl_labor_occprbty,mp_fl_labor_supplied] = bfw_solveequi_kwfw();

Completed BFW_SOLVEEQUI_KWFW;fl_potwrker_1=9.9687;fl_potwrker_2=12.5164;ar_fl_max_ratio_1=0.36095     0.25032     0.20764;ar_fl_max_ratio_2=0.34704     0.23222     0.16538
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C001;sexrhs=;Female;occ=;Manual;wxox=3.5484;laborsupplied=2.2735
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C002;sexrhs=;Female;occ=;Routine;wxox=4.9268;laborsupplied=1.6222
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C003;sexrhs=;Female;occ=;Analytical;wxox=3.523;laborsupplied=1.341
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C101;sexrhs=;Male;occ=;Manual;wxox=1.7656;laborsupplied=4.2925
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C102;sexrhs=;Male;occ=;Routine;wxox=5.9065;laborsupplied=3.7644
BFW_SOLVEEQUI_KWFW-initial-Q;category_key=;C103;sexrhs=;Male;occ=;Analytical;wxox=2.222;laborsupplied=1.5416
Completed BFW_SOLVEEQUI_KWFW;fl_mse_excess=4.4821e-13;ar_w1_iter_endo=1.5779       1.819      3.7951;ar_w2_iter_hat=1.2165      1.8629       3.227;ar_w2_iter_gap=-6.527e-12 -1.9215e-07  8.4457e-07
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2165
    C002    2     2     1.8629
    C003    3     3      3.227
    C101    4     4     1.5779
    C102    5     5      1.819
    C103    6     6     3.7951

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9726

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9726

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C001    1     1      0.13194
    C002    2     2     0.087055
    C003    3     3      0.11714
    C101    4     4      0.43193
    C102    5     5      0.31623
    C103    6     6      0.19788

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_excess_demand Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx       value   
            _    ___    ___________

    C001    1     1     -3.4607e-08
    C002    2     2     -2.3265e-07
    C003    3     3       6.268e-07
    C101    4     4     -2.6645e-15
    C102    5     5     -2.2204e-15
    C103    6     6     -2.2204e-16</code></pre>
</div>
<div id="vary-parameters-solve-equilibrium-quantitieswages-root-search" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Vary Parameters, Solve Equilibrium Quantities/Wages, Root Search</h3>
<pre><code>% 2. Get Parameters and data
bl_log_wage = true;
bl_verbose_nest = false;

% Get Parameters
mp_params = bfw_mp_param_esti(bl_log_wage);
mp_param_aux = bfw_mp_param_aux(bl_verbose_nest);
mp_params = [mp_params ; mp_param_aux];

% Get Data
mp_data = bfw_mp_data(bl_verbose_nest);

% Get Functions
mp_func_demand = bfw_mp_func_demand(bl_verbose_nest);
mp_func_supply = bfw_mp_func_supply(bl_log_wage, bl_verbose_nest);
mp_func_equi = bfw_mp_func_equi(bl_verbose_nest);
mp_func = [mp_func_equi; mp_func_supply; mp_func_demand];

% Get Controls
mp_controls = bfw_mp_control();
mp_controls(&#39;bl_bfw_solveequi_kwfw_display&#39;) = false;
mp_controls(&#39;bl_bfw_solveequi_kwfw_display_verbose&#39;) = false;

st_exa_common_str = &#39;bfw_solveequi_kwfw()&#39;;
for it_example_inputs = [1,2,3,4]

    % Different testing scenariors
    if (it_example_inputs == 1)
        fl_rho_manual = 0.18;
        fl_rho_routine = 0.18;
        fl_rho_analytical = 0.18;

        fl_beta_1_manual = 1 - 0.26;
        fl_beta_1_routine = 1 - 0.30;
        fl_beta_1_analytical = 1 - 0.40;

        fl_Y_manual = 3.4084;
        fl_Y_routine = 2.3402;
        fl_Y_analytical = 1.7552;

        fl_w1o1_init = 2.315707;
        fl_w1o2_init = 3.217799;
        fl_w1o3_init = 4.329016;

        fl_w2o1_init = 1.942;
        fl_w2o2_init = 3.2247;
        fl_w2o3_init = 3.3738;

        it_data_year = 1989;
        fl_potwrker_1 = 9.9687;
        fl_potwrker_2 = 12.5164;
        bl_skilled = false;
        
        st_exa_string = &quot;homogeneous rho at 0.18, unskilled&quot;;

    elseif (it_example_inputs == 2)
        fl_rho_manual = 0.64678;
        fl_rho_routine = 0.64678;
        fl_rho_analytical = 0.64678;

        fl_beta_1_manual = 0.63427;
        fl_beta_1_routine = 0.58738;
        fl_beta_1_analytical = 0.5784;

        fl_Y_manual = 3.2291;
        fl_Y_routine = 2.2223;
        fl_Y_analytical = 1.7487;

        fl_w1o1_init = 2.3157;
        fl_w1o2_init = 3.2178;
        fl_w1o3_init = 4.329;

        fl_w2o1_init = 1.942;
        fl_w2o2_init = 3.2247;
        fl_w2o3_init = 3.3738;

        it_data_year = 1989;
        fl_potwrker_1 = 9.9687;
        fl_potwrker_2 = 12.5164;

        bl_skilled = false;

        st_exa_string = &quot;homogeneous rho at 0.64, unskilled&quot;;

    elseif (it_example_inputs == 3)
        fl_rho_manual = 0.34186;
        fl_rho_routine = 0.34186;
        fl_rho_analytical = 0.34186;

        fl_beta_1_manual = 0.63075;
        fl_beta_1_routine = 0.6326;
        fl_beta_1_analytical = 0.53894;

        fl_Y_manual = 5.5703;
        fl_Y_routine = 4.6673;
        fl_Y_analytical = 2.5644;

        fl_w1o1_init = 2.263;
        fl_w1o2_init = 2.5991;
        fl_w1o3_init = 3.6533;

        fl_w2o1_init = 1.7636;
        fl_w2o2_init = 2.4062;
        fl_w2o3_init = 2.8429;

        it_data_year = 2010;
        fl_potwrker_1 = 16.4952;
        fl_potwrker_2 = 19.4271;

        bl_skilled = false;

        st_exa_string = &quot;homogeneous rho at 0.34, unskilled&quot;;

    elseif (it_example_inputs == 4)
        fl_rho_manual = 0.75002424;
        fl_rho_routine = 0.244249613;
        fl_rho_analytical = 0.244249613;

        fl_beta_1_manual = 0.703785173;
        fl_beta_1_routine = 0.687107264;
        fl_beta_1_analytical = 0.706254232;

        fl_Y_manual = 0.124479951;
        fl_Y_routine = 0.39857586;
        fl_Y_analytical = 1.388880655;

        fl_w1o1_init = 5.758649;
        fl_w1o2_init = 6.221019;
        fl_w1o3_init = 7.977073;

        fl_w2o1_init = 2.376239;
        fl_w2o2_init = 4.863073;
        fl_w2o3_init = 5.881686;

        it_data_year = 1996;
        fl_potwrker_1 = 16.4952;
        fl_potwrker_2 = 19.4271;

        bl_skilled = true;

        st_exa_string = &quot;heter rho (0.75, 0.24, 0.24), skilled&quot;;

    end

    mp_params(&#39;fl_rho_manual&#39;) = fl_rho_manual;
    mp_params(&#39;fl_rho_routine&#39;) = fl_rho_routine;
    mp_params(&#39;fl_rho_analytical&#39;) = fl_rho_analytical;

    mp_params(&#39;fl_beta_1_manual&#39;) = fl_beta_1_manual;
    mp_params(&#39;fl_beta_1_routine&#39;) = fl_beta_1_routine;
    mp_params(&#39;fl_beta_1_analytical&#39;) = fl_beta_1_analytical;

    mp_params(&#39;fl_Y_manual&#39;) = fl_Y_manual;
    mp_params(&#39;fl_Y_routine&#39;) = fl_Y_routine;
    mp_params(&#39;fl_Y_analytical&#39;) = fl_Y_analytical;

    mp_data(&#39;fl_w1o1_init&#39;) = fl_w1o1_init;
    mp_data(&#39;fl_w1o2_init&#39;) = fl_w1o2_init;
    mp_data(&#39;fl_w1o3_init&#39;) = fl_w1o3_init;

    mp_data(&#39;fl_w2o1_init&#39;) = fl_w2o1_init;
    mp_data(&#39;fl_w2o2_init&#39;) = fl_w2o2_init;
    mp_data(&#39;fl_w2o3_init&#39;) = fl_w2o3_init;

    mp_data(&#39;fl_potwrker_1&#39;) = fl_potwrker_1;
    mp_data(&#39;fl_potwrker_2&#39;) = fl_potwrker_2;

    it_data_year = it_data_year - 1989;
    bl_checkminmax = true;
    it_solve_n1n2n3 = 3;
    [ar_w1_iter_endo, ar_w2_iter_hat, ar_w2_iter_gap, ...
        mp_wages, mp_fl_labor_demanded, mp_fl_labor_supplied, ...
        mp_fl_labor_occprbty, fl_mse_excess_demand, mp_fl_labor_excess_demand] = ...
        bfw_solveequi_kwfw(mp_params, mp_data, mp_func, mp_controls, ...
        it_solve_n1n2n3, it_data_year, bl_skilled, bl_checkminmax);

    disp(&#39;&#39;);
    disp(&#39;&#39;);
    disp(&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;);
    disp([&#39;EXAMPLE &#39; num2str(it_example_inputs) &#39;, &#39; st_exa_common_str &#39;, &#39; char(st_exa_string)]);
    disp(&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;);
    ff_container_map_display(mp_wages);
    ff_container_map_display(mp_fl_labor_demanded);
    ff_container_map_display(mp_fl_labor_supplied);
    ff_container_map_display(mp_fl_labor_occprbty);
    ff_container_map_display(mp_fl_labor_excess_demand);

end

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 1, bfw_solveequi_kwfw(), homogeneous rho at 0.18, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2165
    C002    2     2     1.8629
    C003    3     3      3.227
    C101    4     4     1.5779
    C102    5     5      1.819
    C103    6     6     3.7951
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9726
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9726
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C001    1     1      0.13194
    C002    2     2     0.087055
    C003    3     3      0.11714
    C101    4     4      0.43193
    C102    5     5      0.31623
    C103    6     6      0.19788
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_excess_demand Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx       value   
            _    ___    ___________

    C001    1     1     -3.4607e-08
    C002    2     2     -2.3265e-07
    C003    3     3       6.268e-07
    C101    4     4     -2.6645e-15
    C102    5     5     -2.2204e-15
    C103    6     6     -2.2204e-16
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 2, bfw_solveequi_kwfw(), homogeneous rho at 0.64, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2481
    C002    2     2     1.8712
    C003    3     3     3.1468
    C101    4     4     1.5614
    C102    5     5     1.8288
    C103    6     6     3.8377
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6914
    C002    2     2     1.0934
    C003    3     3     1.4297
    C101    4     4     4.2646
    C102    5     5     3.1707
    C103    6     6     1.9952
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6914
    C002    2     2     1.0934
    C003    3     3     1.4297
    C101    4     4     4.2646
    C102    5     5     3.1707
    C103    6     6     1.9952
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C001    1     1      0.13513
    C002    2     2     0.087358
    C003    3     3      0.11423
    C101    4     4      0.42779
    C102    5     5      0.31807
    C103    6     6      0.20015
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_excess_demand Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx       value   
            _    ___    ___________

    C001    1     1      -9.373e-09
    C002    2     2     -1.9675e-07
    C003    3     3      3.6084e-07
    C101    4     4     -8.8818e-16
    C102    5     5      1.3323e-15
    C103    6     6     -2.2204e-16
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 3, bfw_solveequi_kwfw(), homogeneous rho at 0.34, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.5675
    C002    2     2     2.5998
    C003    3     3     3.0763
    C101    4     4     1.9027
    C102    5     5     2.7234
    C103    6     6       3.72
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     3.9729
    C002    2     2     2.8316
    C003    3     3     2.6363
    C101    4     4     6.6763
    C102    5     5     6.0249
    C103    6     6     2.5039
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     3.9729
    C002    2     2     2.8316
    C003    3     3     2.6363
    C101    4     4     6.6763
    C102    5     5     6.0249
    C103    6     6     2.5039
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value 
            _    ___    _______

    C001    1     1      0.2045
    C002    2     2     0.14575
    C003    3     3      0.1357
    C101    4     4     0.40474
    C102    5     5     0.36525
    C103    6     6      0.1518
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_excess_demand Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx       value   
            _    ___    ___________

    C001    1     1      8.8193e-08
    C002    2     2      6.1579e-07
    C003    3     3     -1.2231e-06
    C101    4     4     -3.5527e-15
    C102    5     5      1.7764e-15
    C103    6     6               0
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 4, bfw_solveequi_kwfw(), heter rho (0.75, 0.24, 0.24), skilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C011    1     1     2.2661
    C012    2     2     5.3853
    C013    3     3     6.7077
    C111    4     4     3.5562
    C112    5     5      6.838
    C113    6     6     9.4355
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.032483
    C012    2     2      0.23898
    C013    3     3      0.83121
    C111    4     4       0.1707
    C112    5     5      0.49335
    C113    6     6       1.6895
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.032483
    C012    2     2      0.23898
    C013    3     3      0.83121
    C111    4     4       0.1707
    C112    5     5      0.49335
    C113    6     6       1.6895
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.018322
    C012    2     2       0.1348
    C013    3     3      0.46886
    C111    4     4     0.068174
    C112    5     5      0.19703
    C113    6     6      0.67473
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_excess_demand Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx       value   
            _    ___    ___________

    C011    1     1     -1.8041e-09
    C012    2     2      5.6774e-08
    C013    3     3      8.1332e-08
    C111    4     4     -2.7756e-17
    C112    5     5      5.5511e-17
    C113    6     6      2.2204e-16</code></pre>

</div>
</div>
<div id="equilibrium-w-to-q-to-w-contraction" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Equilibrium W to Q to W Contraction</h2>
<p>This is the example vignette for function: bfw_solveequi_w2q2w from the
<a href="https://fanwangecon.github.io/PrjLabEquiBFW/"><strong>PrjLabEquiBFW
Package</strong></a><strong>.</strong></p>
<div id="default-2" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Default</h3>
<pre><code>[mp_fl_labor_occprbty,mp_fl_labor_supplied] = bfw_solveequi_w2q2w();

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=1;bl_continue=1;fl_ds_gap_mse=1.0294;fl_total_wage_change_mse=2.4494
    2.9507    2.8632    5.2962
    1.7458    2.4472    3.9586

    4.2925    3.7644    1.5416
    2.2735    1.6222    1.3410

    3.9933    2.9733    1.8551
    2.1150    1.2813    1.6136

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=2;bl_continue=1;fl_ds_gap_mse=0.62115;fl_total_wage_change_mse=1.2697
    2.0535    2.6792    5.8550
    1.4375    2.3313    4.0597

    4.9024    3.0389    1.6928
    2.1150    1.2813    1.6136

    4.1907    2.9908    1.7891
    1.8080    1.2610    1.7054

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=10;bl_continue=1;fl_ds_gap_mse=0.0075186;fl_total_wage_change_mse=0.025808
    1.5739    1.8511    3.9011
    1.2165    1.8810    3.2705

    4.3801    3.1280    1.9299
    1.6748    1.0915    1.4595

    4.3088    3.1446    1.9595
    1.6475    1.0973    1.4818

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=20;bl_continue=1;fl_ds_gap_mse=6.4007e-05;fl_total_wage_change_mse=0.0002943
    1.5762    1.8205    3.8023
    1.2159    1.8637    3.2298

    4.3126    3.1498    1.9685
    1.6528    1.0893    1.4649

    4.3065    3.1520    1.9717
    1.6505    1.0900    1.4673

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=30;bl_continue=1;fl_ds_gap_mse=6.0214e-07;fl_total_wage_change_mse=2.8652e-06
    1.5778    1.8191    3.7958
    1.2164    1.8629    3.2273

    4.3064    3.1522    1.9722
    1.6515    1.0896    1.4660

    4.3058    3.1524    1.9726
    1.6513    1.0897    1.4663

ITER:;it_speed_shifter_ctr=1;it_equi_wage_ctr=39;bl_continue=0;fl_ds_gap_mse=9.1058e-09;fl_total_wage_change_mse=4.3545e-08
    1.5780    1.8190    3.7950
    1.2165    1.8628    3.2270

    4.3057    3.1524    1.9727
    1.6514    1.0896    1.4662

    4.3057    3.1524    1.9727
    1.6514    1.0896    1.4662

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2165
    C002    2     2     1.8628
    C003    3     3      3.227
    C101    4     4      1.578
    C102    5     5      1.819
    C103    6     6      3.795

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9727

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9727</code></pre>
</div>
<div id="vary-parameters-solve-equilibrium-quantities-wages-w-to-q-to-w-contraction" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Vary Parameters, Solve Equilibrium Quantities Wages, W to Q to W Contraction</h3>
<pre><code>% 2. Get Parameters and data
bl_log_wage = true;
bl_verbose_nest = false;

% Get Parameters
mp_params = bfw_mp_param_esti(bl_log_wage);
mp_param_aux = bfw_mp_param_aux(bl_verbose_nest);
mp_params = [mp_params ; mp_param_aux];

% Get Data
mp_data = bfw_mp_data(bl_verbose_nest);

% Get Functions
mp_func_demand = bfw_mp_func_demand(bl_verbose_nest);
mp_func_supply = bfw_mp_func_supply(bl_log_wage, bl_verbose_nest);
mp_func_equi = bfw_mp_func_equi(bl_verbose_nest);
mp_func = [mp_func_equi; mp_func_supply; mp_func_demand];

% Get Controls
mp_controls = bfw_mp_control();
mp_controls(&#39;bl_bfw_solveequi_w2q2w_display&#39;) = false;
mp_controls(&#39;bl_bfw_solveequi_w2q2w_display_verbose&#39;) = false;

st_exa_common_str = &#39;bfw_solveequi_w2q2w()&#39;;
for it_example_inputs = [1,2,3,4]

    % Different testing scenariors
    if (it_example_inputs == 1)
        fl_rho_manual = 0.18;
        fl_rho_routine = 0.18;
        fl_rho_analytical = 0.18;

        fl_beta_1_manual = 1 - 0.26;
        fl_beta_1_routine = 1 - 0.30;
        fl_beta_1_analytical = 1 - 0.40;

        fl_Y_manual = 3.4084;
        fl_Y_routine = 2.3402;
        fl_Y_analytical = 1.7552;

        fl_w1o1_init = 2.315707;
        fl_w1o2_init = 3.217799;
        fl_w1o3_init = 4.329016;

        fl_w2o1_init = 1.942;
        fl_w2o2_init = 3.2247;
        fl_w2o3_init = 3.3738;

        it_data_year = 1989;
        fl_potwrker_1 = 9.9687;
        fl_potwrker_2 = 12.5164;
        bl_skilled = false;
        
        st_exa_string = &quot;homogeneous rho at 0.18, unskilled&quot;;

    elseif (it_example_inputs == 2)
        fl_rho_manual = 0.64678;
        fl_rho_routine = 0.64678;
        fl_rho_analytical = 0.64678;

        fl_beta_1_manual = 0.63427;
        fl_beta_1_routine = 0.58738;
        fl_beta_1_analytical = 0.5784;

        fl_Y_manual = 3.2291;
        fl_Y_routine = 2.2223;
        fl_Y_analytical = 1.7487;

        fl_w1o1_init = 2.3157;
        fl_w1o2_init = 3.2178;
        fl_w1o3_init = 4.329;

        fl_w2o1_init = 1.942;
        fl_w2o2_init = 3.2247;
        fl_w2o3_init = 3.3738;

        it_data_year = 1989;
        fl_potwrker_1 = 9.9687;
        fl_potwrker_2 = 12.5164;

        bl_skilled = false;

        st_exa_string = &quot;homogeneous rho at 0.64, unskilled&quot;;

    elseif (it_example_inputs == 3)
        fl_rho_manual = 0.34186;
        fl_rho_routine = 0.34186;
        fl_rho_analytical = 0.34186;

        fl_beta_1_manual = 0.63075;
        fl_beta_1_routine = 0.6326;
        fl_beta_1_analytical = 0.53894;

        fl_Y_manual = 5.5703;
        fl_Y_routine = 4.6673;
        fl_Y_analytical = 2.5644;

        fl_w1o1_init = 2.263;
        fl_w1o2_init = 2.5991;
        fl_w1o3_init = 3.6533;

        fl_w2o1_init = 1.7636;
        fl_w2o2_init = 2.4062;
        fl_w2o3_init = 2.8429;

        it_data_year = 2010;
        fl_potwrker_1 = 16.4952;
        fl_potwrker_2 = 19.4271;

        bl_skilled = false;

        st_exa_string = &quot;homogeneous rho at 0.34, unskilled&quot;;

    elseif (it_example_inputs == 4)
        fl_rho_manual = 0.75002424;
        fl_rho_routine = 0.244249613;
        fl_rho_analytical = 0.244249613;

        fl_beta_1_manual = 0.703785173;
        fl_beta_1_routine = 0.687107264;
        fl_beta_1_analytical = 0.706254232;

        fl_Y_manual = 0.124479951;
        fl_Y_routine = 0.39857586;
        fl_Y_analytical = 1.388880655;

        fl_w1o1_init = 5.758649;
        fl_w1o2_init = 6.221019;
        fl_w1o3_init = 7.977073;

        fl_w2o1_init = 2.376239;
        fl_w2o2_init = 4.863073;
        fl_w2o3_init = 5.881686;

        it_data_year = 1996;
        fl_potwrker_1 = 16.4952;
        fl_potwrker_2 = 19.4271;

        bl_skilled = true;

        st_exa_string = &quot;heter rho (0.75, 0.24, 0.24), skilled&quot;;

    end

    mp_params(&#39;fl_rho_manual&#39;) = fl_rho_manual;
    mp_params(&#39;fl_rho_routine&#39;) = fl_rho_routine;
    mp_params(&#39;fl_rho_analytical&#39;) = fl_rho_analytical;

    mp_params(&#39;fl_beta_1_manual&#39;) = fl_beta_1_manual;
    mp_params(&#39;fl_beta_1_routine&#39;) = fl_beta_1_routine;
    mp_params(&#39;fl_beta_1_analytical&#39;) = fl_beta_1_analytical;

    mp_params(&#39;fl_Y_manual&#39;) = fl_Y_manual;
    mp_params(&#39;fl_Y_routine&#39;) = fl_Y_routine;
    mp_params(&#39;fl_Y_analytical&#39;) = fl_Y_analytical;

    mp_data(&#39;fl_w1o1_init&#39;) = fl_w1o1_init;
    mp_data(&#39;fl_w1o2_init&#39;) = fl_w1o2_init;
    mp_data(&#39;fl_w1o3_init&#39;) = fl_w1o3_init;

    mp_data(&#39;fl_w2o1_init&#39;) = fl_w2o1_init;
    mp_data(&#39;fl_w2o2_init&#39;) = fl_w2o2_init;
    mp_data(&#39;fl_w2o3_init&#39;) = fl_w2o3_init;

    mp_data(&#39;fl_potwrker_1&#39;) = fl_potwrker_1;
    mp_data(&#39;fl_potwrker_2&#39;) = fl_potwrker_2;

    it_data_year = it_data_year - 1989;
    bl_checkminmax = true;
    it_solve_n1n2n3 = 3;
    [~, ~, ~, ~, ~, ~, ~, ~, ~, ...
        mp_wages, mp_fl_labor_demanded, mp_fl_labor_supplied, ...
        mp_fl_labor_occprbty] = ...
        bfw_solveequi_w2q2w(mp_params, mp_data, mp_func, mp_controls, ...
        it_solve_n1n2n3, it_data_year, bl_skilled, bl_checkminmax);

    disp(&#39;&#39;);
    disp(&#39;&#39;);
    disp(&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;);
    disp([&#39;EXAMPLE &#39; num2str(it_example_inputs) &#39;, &#39; st_exa_common_str &#39;, &#39; char(st_exa_string)]);
    disp(&#39;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#39;);
    ff_container_map_display(mp_wages);
    ff_container_map_display(mp_fl_labor_demanded);
    ff_container_map_display(mp_fl_labor_supplied);
    ff_container_map_display(mp_fl_labor_occprbty);

end

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 1, bfw_solveequi_w2q2w(), homogeneous rho at 0.18, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2165
    C002    2     2     1.8628
    C003    3     3      3.227
    C101    4     4      1.578
    C102    5     5      1.819
    C103    6     6      3.795
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9727
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6514
    C002    2     2     1.0896
    C003    3     3     1.4662
    C101    4     4     4.3057
    C102    5     5     3.1524
    C103    6     6     1.9727
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C001    1     1      0.13194
    C002    2     2     0.087055
    C003    3     3      0.11714
    C101    4     4      0.43193
    C102    5     5      0.31623
    C103    6     6      0.19788
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 2, bfw_solveequi_w2q2w(), homogeneous rho at 0.64, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.2482
    C002    2     2     1.8713
    C003    3     3     3.1469
    C101    4     4     1.5614
    C102    5     5     1.8289
    C103    6     6     3.8378
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6914
    C002    2     2     1.0934
    C003    3     3     1.4297
    C101    4     4     4.2646
    C102    5     5     3.1708
    C103    6     6     1.9952
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.6914
    C002    2     2     1.0934
    C003    3     3     1.4297
    C101    4     4     4.2645
    C102    5     5     3.1707
    C103    6     6     1.9952
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C001    1     1      0.13514
    C002    2     2     0.087359
    C003    3     3      0.11423
    C101    4     4      0.42779
    C102    5     5      0.31807
    C103    6     6      0.20014
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 3, bfw_solveequi_w2q2w(), homogeneous rho at 0.34, unskilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     1.5675
    C002    2     2     2.5998
    C003    3     3     3.0763
    C101    4     4     1.9027
    C102    5     5     2.7234
    C103    6     6       3.72
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     3.9729
    C002    2     2     2.8316
    C003    3     3     2.6364
    C101    4     4     6.6763
    C102    5     5     6.0249
    C103    6     6     2.5039
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C001    1     1     3.9729
    C002    2     2     2.8316
    C003    3     3     2.6363
    C101    4     4     6.6763
    C102    5     5     6.0249
    C103    6     6     2.5039
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value 
            _    ___    _______

    C001    1     1      0.2045
    C002    2     2     0.14576
    C003    3     3      0.1357
    C101    4     4     0.40474
    C102    5     5     0.36525
    C103    6     6      0.1518
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
EXAMPLE 4, bfw_solveequi_w2q2w(), heter rho (0.75, 0.24, 0.24), skilled
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_wages Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx    value 
            _    ___    ______

    C011    1     1     2.2661
    C012    2     2     5.3851
    C013    3     3     6.7078
    C111    4     4     3.5562
    C112    5     5     6.8374
    C113    6     6     9.4358
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_demanded Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.032483
    C012    2     2      0.23899
    C013    3     3       0.8312
    C111    4     4       0.1707
    C112    5     5      0.49341
    C113    6     6       1.6894
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_supplied Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.032483
    C012    2     2      0.23897
    C013    3     3      0.83122
    C111    4     4       0.1707
    C112    5     5      0.49336
    C113    6     6       1.6895
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_fl_labor_occprbty Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            i    idx     value  
            _    ___    ________

    C011    1     1     0.018322
    C012    2     2      0.13479
    C013    3     3      0.46886
    C111    4     4     0.068174
    C112    5     5      0.19704
    C113    6     6      0.67473</code></pre>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="supply.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="index-and-code-links.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["BFW-Equilibrium-Gender-LFP-and-Wage-Code-Companion.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
